#include <iostream>

#include <opencv2/core.hpp>
#include <opencv2/imgproc.hpp>
#include <opencv2/highgui/highgui.hpp>

#include "markerDict.h"


markerDict::markerDict() {
	// All markers
	one = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 1, 1, 1,
		1, 0, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	two = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	three = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 0, 0, 0, 1, 1
	};
	four = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 0, 1, 1,
		1, 1, 1, 0, 0, 1, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	five = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	six = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	seven = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 0, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	eight = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	nine = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	zero = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 0, 1, 1, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 1, 1, 0, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	A = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	B = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	C = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	D = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	E = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	F = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	G = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	H = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	I = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	J = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	K = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 0, 1, 1,
		1, 0, 0, 0, 1, 1, 1,
		1, 0, 1, 1, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	L = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	M = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 1, 0, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	N = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 1, 1, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 1, 1, 0, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	O = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	P = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	Q = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 0, 1, 1,
		1, 1, 0, 0, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	R = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	S = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	T = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	U = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	V = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	W = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	X = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	Y = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	Z = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 0, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	question = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 1, 1, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	heart = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 1, 0, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	arrow_u = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	arrow_l = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 1, 0, 0, 0, 0, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 0, 0, 1,
		1, 1, 1, 1, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	arrow_r = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 0, 1, 1, 1,
		1, 0, 0, 0, 0, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 0, 1, 1, 1, 1,
		1, 0, 0, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	dot = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 1, 1, 1, 0, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	square = {
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 0, 0, 0, 1, 1,
		1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	farm = {
		1, 1, 1, 1, 1, 1, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 0, 1, 0, 1, 0, 1,
		1, 0, 0, 0, 0, 0, 1,
		1, 1, 1, 1, 1, 1, 1
	};
	markers = {
		one, two, three, four, five, six, seven, eight, nine, zero
		//A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z,
		//question, heart, arrow_u, arrow_l, arrow_r, dot, square, farm
	};
	// Set maps
	name2marker["one"] = one;
	marker2name[one] = "one";
	name2marker["two"] = two;
	marker2name[two] = "two";
	name2marker["three"] = three;
	marker2name[three] = "three";
	name2marker["four"] = four;
	marker2name[four] = "four";
	name2marker["five"] = five;
	marker2name[five] = "five";
	name2marker["six"] = six;
	marker2name[six] = "six";
	name2marker["seven"] = seven;
	marker2name[seven] = "seven";
	name2marker["eight"] = eight;
	marker2name[eight] = "eight";
	name2marker["nine"] = nine;
	marker2name[nine] = "nine";
	name2marker["zero"] = zero;
	marker2name[zero] = "zero";
	name2marker["A"] = A;
	marker2name[A] = "A";
	name2marker["B"] = B;
	marker2name[B] = "B";
	name2marker["C"] = C;
	marker2name[C] = "C";
	name2marker["D"] = D;
	marker2name[D] = "D";
	name2marker["E"] = E;
	marker2name[E] = "E";
	name2marker["F"] = F;
	marker2name[F] = "F";
	name2marker["G"] = G;
	marker2name[G] = "G";
	name2marker["H"] = H;
	marker2name[H] = "H";
	name2marker["I"] = I;
	marker2name[I] = "I";
	name2marker["J"] = J;
	marker2name[J] = "J";
	name2marker["K"] = K;
	marker2name[K] = "K";
	name2marker["L"] = L;
	marker2name[L] = "L";
	name2marker["M"] = M;
	marker2name[M] = "M";
	name2marker["N"] = N;
	marker2name[N] = "N";
	name2marker["O"] = O;
	marker2name[O] = "O";
	name2marker["P"] = P;
	marker2name[P] = "P";
	name2marker["Q"] = Q;
	marker2name[Q] = "Q";
	name2marker["R"] = R;
	marker2name[R] = "R";
	name2marker["S"] = S;
	marker2name[S] = "S";
	name2marker["T"] = T;
	marker2name[T] = "T";
	name2marker["U"] = U;
	marker2name[U] = "U";
	name2marker["V"] = V;
	marker2name[V] = "V";
	name2marker["W"] = W;
	marker2name[W] = "W";
	name2marker["X"] = X;
	marker2name[X] = "X";
	name2marker["Y"] = Y;
	marker2name[Y] = "Y";
	name2marker["Z"] = Z;
	marker2name[Z] = "Z";
}


std::string markerDict::getMarker(vector<int> candidate) {
	for (vector<int> marker : markers) {
		cv::Mat marker_mat = cv::Mat(marker).reshape(0, 7);
		marker_mat.convertTo(marker_mat, CV_8UC1);
		cv::Mat candidate_mat = cv::Mat(candidate).reshape(0, 7);
		candidate_mat.convertTo(candidate_mat, CV_8UC1);
		cv::Mat diff(7, 7, CV_8U, cv::Scalar::all(0));
		cv::absdiff(marker_mat, candidate_mat, diff);
		if ((int)cv::countNonZero(diff) <= 3) {
			return marker2name[marker];
		}
	}
	return "none";
}
